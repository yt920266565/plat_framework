<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>页面访问记录</title>
  <link rel="stylesheet" href="/static/layui-v2.5.6/layui/css/layui.css"  media="all">
  <link href="/static/layui-v2.5.6/layui/css/modules/layer/default/layer.css" rel="stylesheet"/>
  <script src="/static/js/jquery.min.js" charset="utf-8"></script>
  <script src="/static/layui-v2.5.6/layui/layui.js" charset="utf-8"></script>
  <script src="/static/templates/common.js" charset="utf-8"></script>
</head>
<style type="text/css">
.layui-table-cell {
    height: 23px;
}
</style>
<!-- style="overflow-x:hidden;overflow-y:hidden" -->
<body >
  
  <div style="text-align:center">
    <label>最近:</label>
	<form class="layui-form"  style="display: inline-block;width:30%">
		<select class="layui-form" id="accessTime" lay-filter="accessTime" lay-verify="" lay-search>
			<option value="oneWeek">一周</option>
			<option value="oneMonth">一个月</option>
			<option value="threeWeek">三个月</option>
			<option value="halfYear">半年</option>
			<option value="oneYear">一年</option>
		</select>
	</form>
  </div>
  
	<table class="layui-table" lay-filter="accessTable" id="accessTable">
	 
	</table>



</body>

<script type="text/javascript">
var storage=window.localStorage;
var token = storage.getItem("token");

var url = window.location.search;
if(url != ''){
	url = url.split("=")[1];
}

layui.use(['form','laydate','table'],function(){
  	var form = layui.form,laydate = layui.laydate,$ = layui.$,table = layui.table;
	table.render({
		elem : '#accessTable',
		url : '/accessRecord?url='+url,
		limit : 20,
		cols : [[
		     {field:'',align:'center',title: '访问人员',templet:function(d){
		    	 return d.staffName+'-'+d.staffCode;
		     }}
		    ,{field:'', title: '访问时间',templet:function(d){
		    	return dateFormat(d.accessTime);
		    }}
		    ,{field:'menuName', title: '访问页面名'}
		]],
		page:true,
		id : 'accessTable'
	});
	
	function tableReload(){
		var time = $('#accessTime').val();
		table.reload('accessTable',{
	        where: {
	        	"time":time
	        },page: {
		           curr: 1 //重新从第 1 页开始
		      }
		  });
	}
	
	form.on('select(accessTime)',function(){
		tableReload();
	})
})



</script>

</html>